{% extends 'base.html' %}

{% block title %}Payment Status{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="card border-0 shadow-lg text-center">
            <div class="card-body p-5">
                {% if payment.status == 'COMPLETED' %}
                    <i class="fas fa-check-circle fa-5x text-success mb-4"></i>
                    <h2 class="fw-bold text-success mb-3">Payment Successful!</h2>
                    <p class="lead mb-4">Your order has been confirmed and is being processed.</p>
                    
                    <div class="bg-light rounded p-3 mb-4">
                        <p class="mb-1 text-muted small">M-Pesa Receipt</p>
                        <p class="fw-bold mb-0 h5" style="color: #2E5A39;">{{ payment.mpesa_receipt }}</p>
                    </div>
                    
                    <a href="{% url 'products' %}" class="btn btn-primary-custom btn-lg">
                        <i class="fas fa-shopping-bag me-2"></i> Continue Shopping
                    </a>
                {% else %}
                    <div class="spinner-border mb-4" style="width: 4rem; height: 4rem; color: #2E5A39;" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <h3 class="fw-bold mb-3" style="color: #2E5A39;">Processing Payment...</h3>
                    <p class="lead mb-4">Please check your phone and enter your M-Pesa PIN</p>
                    
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        This page will automatically refresh
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% if payment.status != 'COMPLETED' %}
<script>
    setTimeout(function(){
        location.reload();
    }, 5000);
</script>
{% endif %}
{% endblock %}